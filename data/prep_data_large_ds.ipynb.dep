{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/spartee/.virtualenvs/vss-fashion/lib/python3.8/site-packages/tqdm/auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
      "  from .autonotebook import tqdm as notebook_tqdm\n"
     ]
    }
   ],
   "source": [
    "import json\n",
    "import typing as t\n",
    "\n",
    "# data prep\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "# for creating image vector embeddings\n",
    "from PIL import Image\n",
    "from img2vec_pytorch import Img2Vec\n",
    "\n",
    "# for creating semantic (text-based) vector embeddings\n",
    "from sentence_transformers import SentenceTransformer\n",
    "\n",
    "# plotting\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 44077 entries, 0 to 44423\n",
      "Data columns (total 10 columns):\n",
      " #   Column              Non-Null Count  Dtype \n",
      "---  ------              --------------  ----- \n",
      " 0   id                  44077 non-null  int64 \n",
      " 1   gender              44077 non-null  object\n",
      " 2   masterCategory      44077 non-null  object\n",
      " 3   subCategory         44077 non-null  object\n",
      " 4   articleType         44077 non-null  object\n",
      " 5   baseColour          44077 non-null  object\n",
      " 6   season              44077 non-null  object\n",
      " 7   year                44077 non-null  int64 \n",
      " 8   usage               44077 non-null  object\n",
      " 9   productDisplayName  44077 non-null  object\n",
      "dtypes: int64(2), object(8)\n",
      "memory usage: 3.7+ MB\n"
     ]
    }
   ],
   "source": [
    "DATA_PATH = \"/home/spartee/dev/datasets/fashion-dataset\"\n",
    "\n",
    "# load in data and clean data types and drop null rows\n",
    "metadata = pd.read_csv(DATA_PATH + \"/styles.csv\", on_bad_lines='skip')\n",
    "metadata.dropna(inplace=True)\n",
    "metadata[\"year\"] = metadata[\"year\"].astype(int)\n",
    "metadata.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'notification': {},\n",
       " 'meta': {'code': 200, 'requestId': '832d54ee-d88b-4f34-a962-26321d73691c'},\n",
       " 'data': {'id': 6041,\n",
       "  'price': 1499,\n",
       "  'discountedPrice': 1499,\n",
       "  'styleType': 'P',\n",
       "  'productTypeId': 289,\n",
       "  'articleNumber': '11P3084J0926I203',\n",
       "  'visualTag': '',\n",
       "  'productDisplayName': \"UCB Men's Polo Neck With Lion Logo Navy Blue T-shirt\",\n",
       "  'variantName': 'H/S Polo Neck t-Shirt with Lion Logo',\n",
       "  'myntraRating': 0,\n",
       "  'catalogAddDate': 1446705981,\n",
       "  'brandName': 'United Colors of Benetton',\n",
       "  'ageGroup': 'Adults-Men',\n",
       "  'gender': 'Men',\n",
       "  'baseColour': 'Navy Blue',\n",
       "  'colour1': '',\n",
       "  'colour2': '',\n",
       "  'fashionType': 'Fashion',\n",
       "  'season': 'Summer',\n",
       "  'year': '2011',\n",
       "  'usage': 'Casual',\n",
       "  'vat': 5.5,\n",
       "  'displayCategories': 'Casual Wear,Sale',\n",
       "  'weight': '0',\n",
       "  'navigationId': 0,\n",
       "  'landingPageUrl': 'Tshirts/United-Colors-of-Benetton/UCB-Mens-Polo-Neck-With-Lion-Logo-Navy-Blue-T-shirt/6041/buy',\n",
       "  'articleAttributes': {'Body or Garment Size': 'Garment Measurements in'},\n",
       "  'crossLinks': [{'key': 'More Tshirts by United Colors of Benetton',\n",
       "    'value': 'tshirts?f=brand:United Colors of Benetton::gender:men'},\n",
       "   {'key': 'More Navy Blue Tshirts',\n",
       "    'value': 'tshirts?f=colour:Navy Blue::gender:men'},\n",
       "   {'key': 'More Tshirts', 'value': 'tshirts?f=gender:men'}],\n",
       "  'brandUserProfile': {'uidx': '2ae8b8a9.57f2.400f.8b56.49382d4ddb7dUZuemospne',\n",
       "   'bio': 'Focused on the Future',\n",
       "   'name': 'United Colors of Benetton',\n",
       "   'image': 'http://assets.myntassets.com/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg',\n",
       "   'publicProfileId': 'Brand.UCB',\n",
       "   'imageJsonEntryMap': {'0': '{\"id\":24519680,\"createdBy\":\"2ae8b8a9.57f2.400f.8b56.49382d4ddb7dUZuemospne\",\"createdOn\":1487140406000,\"lastModifiedOn\":1487140406000,\"version\":0,\"format\":\"JPEG\",\"isCompressed\":false,\"resolution\":\"1020X1020\",\"aspectRatio\":\"1:1\",\"viewtype\":\"front\",\"client_id\":4,\"client_description\":\"video_migration_script\",\"client_reference_id\":\"24519680\",\"imgs\":{\"S3\":{\"id\":40953183,\"relativePath\":\"assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"size\":37641,\"domain\":\"http://myntra.myntassets.com/\",\"securedDomain\":\"https://myntrawebimages.s3.amazonaws.com/\",\"resolutionFormula\":\"assets/images/2017/2/15/11487140406222-47823-gtua1a_($width)_($height).jpg\",\"path\":\"http://myntra.myntassets.com/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"storedUploaderType\":\"S3\",\"servingUploaderType\":\"S3\"},\"CL\":{\"id\":40953182,\"relativePath\":\"assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"size\":37641,\"domain\":\"http://assets.myntassets.com/\",\"securedDomain\":\"https://secureassets.myntassets.com/\",\"resolutionFormula\":\"h_($height),q_($qualityPercentage),w_($width)/v1/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"path\":\"http://assets.myntassets.com/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"storedUploaderType\":\"CL\",\"servingUploaderType\":\"CL\"}},\"path\":\"assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\",\"securedDomain\":\"https://secureassets.myntassets.com/\",\"domain\":\"http://assets.myntassets.com/\",\"storedUploaderType\":\"CL\",\"servingUploaderType\":\"CL\",\"resolutionFormula\":\"h_($height),q_($qualityPercentage),w_($width)/v1/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg\"}',\n",
       "    '1': '{\"id\":11155027,\"createdBy\":\"2ae8b8a9.57f2.400f.8b56.49382d4ddb7dUZuemospne\",\"createdOn\":1457699215000,\"lastModifiedOn\":1457699215000,\"version\":0,\"format\":\"jpg\",\"isCompressed\":false,\"resolution\":\"1080X816\",\"aspectRatio\":\"45:34\",\"viewtype\":\"front\",\"client_id\":4,\"client_description\":\"video_migration_script\",\"client_reference_id\":\"11155027\",\"imgs\":{\"S3\":{\"id\":20254594,\"relativePath\":\"assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"size\":152284,\"domain\":\"http://myntra.myntassets.com/\",\"securedDomain\":\"https://myntrawebimages.s3.amazonaws.com/\",\"resolutionFormula\":\"assets/images/2016/3/11/11457699215305-6306-1qdafsn_($width)_($height).jpg\",\"path\":\"http://myntra.myntassets.com/assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"storedUploaderType\":\"S3\",\"servingUploaderType\":\"S3\"},\"CL\":{\"id\":20254593,\"relativePath\":\"assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"size\":152284,\"domain\":\"http://assets.myntassets.com/\",\"securedDomain\":\"https://secureassets.myntassets.com/\",\"resolutionFormula\":\"h_($height),q_($qualityPercentage),w_($width)/v1/assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"path\":\"http://assets.myntassets.com/assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"storedUploaderType\":\"CL\",\"servingUploaderType\":\"CL\"}},\"path\":\"assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\",\"securedDomain\":\"https://secureassets.myntassets.com/\",\"domain\":\"http://assets.myntassets.com/\",\"storedUploaderType\":\"CL\",\"servingUploaderType\":\"CL\",\"resolutionFormula\":\"h_($height),q_($qualityPercentage),w_($width)/v1/assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg\"}',\n",
       "    '2': 'http://assets.myntassets.com/assets/images/2017/2/15/11487140406222-47823-gtua1a.jpg',\n",
       "    '3': 'http://assets.myntassets.com/assets/images/2016/3/11/11457699215305-6306-1qdafsn.jpg'},\n",
       "   'tagsMap': '{\"roles\":[],\"labels\":[],\"myntraVerified\":true,\"invited\":true,\"brandUrl\":\"/united-colors-of-benetton\"}'},\n",
       "  'codEnabled': True,\n",
       "  'colours': {'colors': {'6043': {'dre_landing_page_url': 'Tshirts/United-Colors-of-Benetton/UCB-Mens-Polo-Neck-With-Lion-Logo-Red-T-shirt/6043/buy',\n",
       "     'styleid': 6043,\n",
       "     'global_attr_colour1': 'NA',\n",
       "     'global_attr_base_colour': 'Red',\n",
       "     'search_image': 'http://assets.myntassets.com/v1/images/style/properties/ebf78d2f0039d8a366c50dff93ced9af_images.jpg'},\n",
       "    '6192': {'dre_landing_page_url': 'Tshirts/United-Colors-of-Benetton/UCB-Mens-Lion-Logo-White-T-shirt/6192/buy',\n",
       "     'styleid': 6192,\n",
       "     'global_attr_colour1': 'NA',\n",
       "     'global_attr_base_colour': 'White',\n",
       "     'search_image': 'http://assets.myntassets.com/v1/images/style/properties/a52069620e30ddf10dfc8cf3a3af0379_images.jpg'}}},\n",
       "  'styleImages': {'default': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg'},\n",
       "    'imageType': 'default'},\n",
       "   'size_representation': 'http://assets.myntassets.com/assets/images/sizechart/2016/12/14/11481690842463-Tshirts_men.png',\n",
       "   'search': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/b54b7d7f19b9dbb54c85c584719c46ef_images_mini.jpg'},\n",
       "    'imageType': 'search'},\n",
       "   'back': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/617550c0f0c4c46cab9fee6fd6d1cd30_images_mini.jpg'},\n",
       "    'imageType': 'back'},\n",
       "   'front': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/4426a489df207a35f61d4d947a873df9_images_mini.jpg'},\n",
       "    'imageType': 'front'},\n",
       "   'right': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/39aee1e200629e8cd059002785ef57ea_images_mini.jpg'},\n",
       "    'imageType': 'right'},\n",
       "   'top': {'imageURL': 'http://assets.myntassets.com/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "    'resolutions': {'1080X1440Xmini': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg',\n",
       "     '48X64': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '1080X1440': 'http://assets.myntassets.com/h_1440,q_95,w_1080/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '150X200': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '360X480': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '180X240': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '360X480Xmini': 'http://assets.myntassets.com/h_480,q_95,w_360/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg',\n",
       "     '180X240Xmini': 'http://assets.myntassets.com/h_240,q_95,w_180/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg',\n",
       "     '150X200Xmini': 'http://assets.myntassets.com/h_200,q_95,w_150/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg',\n",
       "     '48X64Xmini': 'http://assets.myntassets.com/h_64,q_95,w_48/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg',\n",
       "     '125X161': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images.jpg',\n",
       "     '125X161Xmini': 'http://assets.myntassets.com/h_161,q_95,w_125/v1/images/style/properties/818f19e31615ad94aff618fa6d033a19_images_mini.jpg'},\n",
       "    'imageType': 'top'}},\n",
       "  'lookGoodAlbum': {},\n",
       "  'style360Images': {},\n",
       "  'masterCategory': {'id': 9,\n",
       "   'typeName': 'Apparel',\n",
       "   'active': True,\n",
       "   'socialSharingEnabled': True,\n",
       "   'isReturnable': True,\n",
       "   'isExchangeable': True,\n",
       "   'pickupEnabled': True,\n",
       "   'isTryAndBuyEnabled': True},\n",
       "  'subCategory': {'id': 31,\n",
       "   'typeName': 'Topwear',\n",
       "   'active': True,\n",
       "   'socialSharingEnabled': True,\n",
       "   'isReturnable': True,\n",
       "   'isExchangeable': True,\n",
       "   'pickupEnabled': True,\n",
       "   'isTryAndBuyEnabled': True},\n",
       "  'articleType': {'id': 90,\n",
       "   'typeName': 'Tshirts',\n",
       "   'active': True,\n",
       "   'socialSharingEnabled': True,\n",
       "   'isReturnable': True,\n",
       "   'isExchangeable': True,\n",
       "   'pickupEnabled': True,\n",
       "   'isTryAndBuyEnabled': True,\n",
       "   'isMyntsEnabled': True,\n",
       "   'serviceabilityDisclaimer': {'title': '', 'desc': ''}},\n",
       "  'isEMIEnabled': True,\n",
       "  'otherFlags': [{'dataType': 'BOOLEAN',\n",
       "    'name': 'isFragile',\n",
       "    'value': 'false'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isTryAndBuyEnabled', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isHazmat', 'value': 'false'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isJewellery', 'value': 'false'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isReturnable', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isExchangeable', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'active', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'socialSharingEnabled', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'pickupEnabled', 'value': 'true'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'isLarge', 'value': 'false'},\n",
       "   {'dataType': 'BOOLEAN', 'name': 'codEnabled', 'value': 'true'}],\n",
       "  'articleDisplayAttr': {'id': 90,\n",
       "   'core': {'order': '0',\n",
       "    'display': '2',\n",
       "    'pdtDetail': '1',\n",
       "    'pdtDeliveryOptions': '2',\n",
       "    'pdtSimilar': '2',\n",
       "    'pdtLike': '2'},\n",
       "   'social': {'order': '1',\n",
       "    'display': '2',\n",
       "    'userLikes': '1',\n",
       "    'styleNotes': '2',\n",
       "    'crossSell': '1'},\n",
       "   'explore': {'display': '2',\n",
       "    'crosslink': '1',\n",
       "    'similar': '1',\n",
       "    'order': '2'}},\n",
       "  'productDescriptors': {'description': {'descriptorType': 'description',\n",
       "    'value': '<p style=\"text-align: justify;\"><strong>Composition</strong><br />Navy blue polo t-shirt made of 100% cotton, with a ribbed collar and cuffs, buttoned rugged placket, vented shirt side ends and embroidered lion emblem on left chest, embroidered Italian flag on right chest, numbers 19 and 65 embroidered on the sleeves<br /><br /><strong>Fitting</strong><br />Comfort<br /><br />Wash care</p>\\n<ul>\\n<li>Delicate machine wash at 30 degrees</li>\\n<li>Use mild detergent</li>\\n<li>Do not tumble dry</li>\\n<li>Do not wring</li>\\n<li>Do not scrub</li>\\n<li>Do not bleach</li>\\n<li>Do not dry clean</li>\\n<li>Do not dry in direct sunlight</li>\\n<li>Dry flat in shade</li>\\n<li>Warm iron</li>\\n<li>Do not iron directly on print/embroidery</li>\\n</ul>\\n<p style=\"text-align: justify;\">Subtle and stylish, this navy blue polo neck t-shirt from the united colors of benetton speaks volumes of your sense of heightened style. The thickly embroidered lion logo, the Italian flag and the number 1965 split across the sleeves pay homage to the year of commencement and the brand\\'s country of origin. The ribbed sleeve hems contour your well-toned arms perfectly, while the slits at the shirt ends offer a comfortable Fit. Team this with jeans and lifestyle sportswear for that cool, casual look.<br /><br /><em>Model statistics</em><br />The model wears size M in t-shirts<br />Height-6\\', Shoulders-18\"</p>'}},\n",
       "  'styleOptions': [{'id': 22806,\n",
       "    'name': 'Size',\n",
       "    'value': 'S',\n",
       "    'unifiedSize': 'S',\n",
       "    'unifiedSizeValue': 'S',\n",
       "    'unifiedSizeScale': '',\n",
       "    'allSize': 'S',\n",
       "    'skuId': 24713,\n",
       "    'skuAvailabilityDetailMap': {},\n",
       "    'warehouseIdToItemCountMap': {},\n",
       "    'inventoryCount': 0,\n",
       "    'available': False,\n",
       "    'active': True},\n",
       "   {'id': 22807,\n",
       "    'name': 'Size',\n",
       "    'value': 'M',\n",
       "    'unifiedSize': 'M',\n",
       "    'unifiedSizeValue': 'M',\n",
       "    'unifiedSizeScale': '',\n",
       "    'allSize': 'M',\n",
       "    'skuId': 24714,\n",
       "    'skuAvailabilityDetailMap': {},\n",
       "    'warehouseIdToItemCountMap': {},\n",
       "    'inventoryCount': 0,\n",
       "    'available': False,\n",
       "    'active': True},\n",
       "   {'id': 22808,\n",
       "    'name': 'Size',\n",
       "    'value': 'L',\n",
       "    'unifiedSize': 'L',\n",
       "    'unifiedSizeValue': 'L',\n",
       "    'unifiedSizeScale': '',\n",
       "    'allSize': 'L',\n",
       "    'skuId': 24715,\n",
       "    'skuAvailabilityDetailMap': {},\n",
       "    'warehouseIdToItemCountMap': {},\n",
       "    'inventoryCount': 0,\n",
       "    'available': False,\n",
       "    'active': True},\n",
       "   {'id': 22809,\n",
       "    'name': 'Size',\n",
       "    'value': 'XL',\n",
       "    'unifiedSize': 'XL',\n",
       "    'unifiedSizeValue': 'XL',\n",
       "    'unifiedSizeScale': '',\n",
       "    'allSize': 'XL',\n",
       "    'skuId': 24716,\n",
       "    'skuAvailabilityDetailMap': {},\n",
       "    'warehouseIdToItemCountMap': {},\n",
       "    'inventoryCount': 0,\n",
       "    'available': False,\n",
       "    'active': True},\n",
       "   {'id': 71663,\n",
       "    'name': 'Size',\n",
       "    'value': 'XXL',\n",
       "    'unifiedSize': 'XXL',\n",
       "    'unifiedSizeValue': 'XXL',\n",
       "    'unifiedSizeScale': '',\n",
       "    'allSize': 'XXL',\n",
       "    'skuId': 71358,\n",
       "    'skuAvailabilityDetailMap': {},\n",
       "    'warehouseIdToItemCountMap': {},\n",
       "    'inventoryCount': 0,\n",
       "    'available': False,\n",
       "    'active': True}]}}"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check out some of the JSON data.\n",
    "data = json.loads(open(DATA_PATH + \"/styles/6041.json\", \"r\").read())\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "from io import StringIO\n",
    "from html.parser import HTMLParser\n",
    "\n",
    "class MLStripper(HTMLParser):\n",
    "    def __init__(self):\n",
    "        super().__init__()\n",
    "        self.reset()\n",
    "        self.strict = False\n",
    "        self.convert_charrefs= True\n",
    "        self.text = StringIO()\n",
    "    def handle_data(self, d):\n",
    "        self.text.write(d)\n",
    "    def get_data(self):\n",
    "        return self.text.getvalue()\n",
    "\n",
    "\n",
    "def strip_tags(html):\n",
    "    s = MLStripper()\n",
    "    s.feed(html)\n",
    "    return s.get_data()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>gender</th>\n",
       "      <th>masterCategory</th>\n",
       "      <th>subCategory</th>\n",
       "      <th>articleType</th>\n",
       "      <th>baseColour</th>\n",
       "      <th>season</th>\n",
       "      <th>year</th>\n",
       "      <th>usage</th>\n",
       "      <th>productDisplayName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>33700</th>\n",
       "      <td>16065</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Trousers</td>\n",
       "      <td>Navy Blue</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Highlander Men Solid Blue Trouser</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>418</th>\n",
       "      <td>31588</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>Maroon</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Mark Taylor Men Printed Maroon T-shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24934</th>\n",
       "      <td>56470</td>\n",
       "      <td>Women</td>\n",
       "      <td>Personal Care</td>\n",
       "      <td>Nails</td>\n",
       "      <td>Nail Polish</td>\n",
       "      <td>Magenta</td>\n",
       "      <td>Spring</td>\n",
       "      <td>2017</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Streetwear Magenta Nail Polish 59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37529</th>\n",
       "      <td>29083</td>\n",
       "      <td>Men</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>Wallets</td>\n",
       "      <td>Wallets</td>\n",
       "      <td>Brown</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Fastrack Men Leather Brown Wallet</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22648</th>\n",
       "      <td>10004</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Shorts</td>\n",
       "      <td>Grey</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Sports</td>\n",
       "      <td>Nike Men As 7 Sw Temp Grey Shorts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37547</th>\n",
       "      <td>33519</td>\n",
       "      <td>Women</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Shoes</td>\n",
       "      <td>Heels</td>\n",
       "      <td>Black</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Cobblerz Women Black Wedges</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2354</th>\n",
       "      <td>19184</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Shirts</td>\n",
       "      <td>Red</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>United Colors Of Benetton Men Red Check Shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40651</th>\n",
       "      <td>49611</td>\n",
       "      <td>Women</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Shoes</td>\n",
       "      <td>Heels</td>\n",
       "      <td>Olive</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2015</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Catwalk Women Olive Flats</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24161</th>\n",
       "      <td>56819</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Shirts</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>John Players Men Blue Shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43641</th>\n",
       "      <td>17235</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>White</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>U.S. Polo Assn. Men Solid White  Polo Tshirt</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40000 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id gender masterCategory subCategory  articleType baseColour  \\\n",
       "33700  16065    Men        Apparel  Bottomwear     Trousers  Navy Blue   \n",
       "418    31588    Men        Apparel     Topwear      Tshirts     Maroon   \n",
       "24934  56470  Women  Personal Care       Nails  Nail Polish    Magenta   \n",
       "37529  29083    Men    Accessories     Wallets      Wallets      Brown   \n",
       "22648  10004    Men        Apparel  Bottomwear       Shorts       Grey   \n",
       "...      ...    ...            ...         ...          ...        ...   \n",
       "37547  33519  Women       Footwear       Shoes        Heels      Black   \n",
       "2354   19184    Men        Apparel     Topwear       Shirts        Red   \n",
       "40651  49611  Women       Footwear       Shoes        Heels      Olive   \n",
       "24161  56819    Men        Apparel     Topwear       Shirts       Blue   \n",
       "43641  17235    Men        Apparel     Topwear      Tshirts      White   \n",
       "\n",
       "       season  year   usage                             productDisplayName  \n",
       "33700    Fall  2011  Casual              Highlander Men Solid Blue Trouser  \n",
       "418    Summer  2012  Casual         Mark Taylor Men Printed Maroon T-shirt  \n",
       "24934  Spring  2017  Casual              Streetwear Magenta Nail Polish 59  \n",
       "37529  Winter  2016  Casual              Fastrack Men Leather Brown Wallet  \n",
       "22648    Fall  2011  Sports              Nike Men As 7 Sw Temp Grey Shorts  \n",
       "...       ...   ...     ...                                            ...  \n",
       "37547  Summer  2016  Casual                    Cobblerz Women Black Wedges  \n",
       "2354     Fall  2011  Casual  United Colors Of Benetton Men Red Check Shirt  \n",
       "40651  Winter  2015  Casual                      Catwalk Women Olive Flats  \n",
       "24161  Summer  2012  Casual                    John Players Men Blue Shirt  \n",
       "43641    Fall  2011  Casual   U.S. Polo Assn. Men Solid White  Polo Tshirt  \n",
       "\n",
       "[40000 rows x 10 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product_data = metadata.sample(40000)\n",
    "product_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>brand</th>\n",
       "      <th>age_group</th>\n",
       "      <th>description</th>\n",
       "      <th>image_url</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>15970</td>\n",
       "      <td>Turtle</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>CompositionDark brown and indigo blue plaid ch...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>39386</td>\n",
       "      <td>Peter England</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Style Note Look cool and casual in these jeans...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>59263</td>\n",
       "      <td>Titan</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Silver steel case with a fixed bezel for durab...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21379</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Composition Black Official Merchandise manches...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>53759</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Grey knit polo T-shirt with moisture managemen...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44003</th>\n",
       "      <td>17036</td>\n",
       "      <td>GAS</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Have fun choosing from a collection of sneaker...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44004</th>\n",
       "      <td>6461</td>\n",
       "      <td>Lotto</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Get ready for that long overdue trip to the be...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44005</th>\n",
       "      <td>18842</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Composition Blue T-shirt made of 100% cotton, ...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44006</th>\n",
       "      <td>46694</td>\n",
       "      <td>Rasasi</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Style Note rasasi impresses and flatters your ...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44007</th>\n",
       "      <td>51623</td>\n",
       "      <td>Fossil</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Case style: Analogue watch, has a circular cas...</td>\n",
       "      <td>http://assets.myntassets.com/assets/images/516...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>44008 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id              brand     age_group  \\\n",
       "0      15970             Turtle    Adults-Men   \n",
       "1      39386      Peter England    Adults-Men   \n",
       "2      59263              Titan  Adults-Women   \n",
       "3      21379  Manchester United    Adults-Men   \n",
       "4      53759               Puma    Adults-Men   \n",
       "...      ...                ...           ...   \n",
       "44003  17036                GAS    Adults-Men   \n",
       "44004   6461              Lotto    Adults-Men   \n",
       "44005  18842               Puma    Adults-Men   \n",
       "44006  46694             Rasasi  Adults-Women   \n",
       "44007  51623             Fossil  Adults-Women   \n",
       "\n",
       "                                             description  \\\n",
       "0      CompositionDark brown and indigo blue plaid ch...   \n",
       "1      Style Note Look cool and casual in these jeans...   \n",
       "2      Silver steel case with a fixed bezel for durab...   \n",
       "3      Composition Black Official Merchandise manches...   \n",
       "4      Grey knit polo T-shirt with moisture managemen...   \n",
       "...                                                  ...   \n",
       "44003  Have fun choosing from a collection of sneaker...   \n",
       "44004  Get ready for that long overdue trip to the be...   \n",
       "44005  Composition Blue T-shirt made of 100% cotton, ...   \n",
       "44006  Style Note rasasi impresses and flatters your ...   \n",
       "44007  Case style: Analogue watch, has a circular cas...   \n",
       "\n",
       "                                               image_url  \n",
       "0      http://assets.myntassets.com/v1/images/style/p...  \n",
       "1      http://assets.myntassets.com/v1/images/style/p...  \n",
       "2      http://assets.myntassets.com/v1/images/style/p...  \n",
       "3      http://assets.myntassets.com/v1/images/style/p...  \n",
       "4      http://assets.myntassets.com/v1/images/style/p...  \n",
       "...                                                  ...  \n",
       "44003  http://assets.myntassets.com/v1/images/style/p...  \n",
       "44004  http://assets.myntassets.com/v1/images/style/p...  \n",
       "44005  http://assets.myntassets.com/v1/images/style/p...  \n",
       "44006  http://assets.myntassets.com/v1/images/style/p...  \n",
       "44007  http://assets.myntassets.com/assets/images/516...  \n",
       "\n",
       "[44008 rows x 5 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product_meta = []\n",
    "for index, row in metadata.iterrows():\n",
    "    product = {\"id\": row[\"id\"]}\n",
    "    json_file = DATA_PATH + \"/styles/\" + str(row[\"id\"]) + \".json\"\n",
    "    # open and read json data\n",
    "    json_data = json.loads(open(json_file, \"r\").read())[\"data\"]\n",
    "    # extract relevant data\n",
    "    product[\"brand\"] = json_data[\"brandName\"]\n",
    "    product[\"age_group\"] = json_data[\"ageGroup\"]\n",
    "    try:\n",
    "        product[\"description\"] = strip_tags(json_data[\"productDescriptors\"][\"description\"][\"value\"])\n",
    "        product[\"image_url\"] = json_data[\"styleImages\"][\"default\"][\"imageURL\"]\n",
    "        product_meta.append(product)\n",
    "    except KeyError:\n",
    "        continue\n",
    "\n",
    "product_meta_from_json = pd.DataFrame(product_meta)\n",
    "product_meta_from_json"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([21817.,     0., 18125.,     0.,  1063.,     0.,   847.,     0.,\n",
       "         1887.,   269.]),\n",
       " array([0. , 0.5, 1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5, 5. ]),\n",
       " <BarContainer object of 10 artists>)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# plot the distribution of the age group\n",
    "plt.hist(product_meta_from_json[\"age_group\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>brand</th>\n",
       "      <th>age_group</th>\n",
       "      <th>description</th>\n",
       "      <th>image_url</th>\n",
       "      <th>gender</th>\n",
       "      <th>masterCategory</th>\n",
       "      <th>subCategory</th>\n",
       "      <th>articleType</th>\n",
       "      <th>baseColour</th>\n",
       "      <th>season</th>\n",
       "      <th>year</th>\n",
       "      <th>usage</th>\n",
       "      <th>productDisplayName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>15970</td>\n",
       "      <td>Turtle</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>CompositionDark brown and indigo blue plaid ch...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Shirts</td>\n",
       "      <td>Navy Blue</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Turtle Check Men Navy Blue Shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>39386</td>\n",
       "      <td>Peter England</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Style Note Look cool and casual in these jeans...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Jeans</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Peter England Men Party Blue Jeans</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>59263</td>\n",
       "      <td>Titan</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Silver steel case with a fixed bezel for durab...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Silver</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Titan Women Silver Watch</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21379</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Composition Black Official Merchandise manches...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Track Pants</td>\n",
       "      <td>Black</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Manchester United Men Solid Black Track Pants</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>53759</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Grey knit polo T-shirt with moisture managemen...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>Grey</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Puma Men Grey T-shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44003</th>\n",
       "      <td>17036</td>\n",
       "      <td>GAS</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Have fun choosing from a collection of sneaker...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Shoes</td>\n",
       "      <td>Casual Shoes</td>\n",
       "      <td>White</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2013</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Gas Men Caddy Casual Shoe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44004</th>\n",
       "      <td>6461</td>\n",
       "      <td>Lotto</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Get ready for that long overdue trip to the be...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Flip Flops</td>\n",
       "      <td>Flip Flops</td>\n",
       "      <td>Red</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Lotto Men's Soccer Track Flip Flop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44005</th>\n",
       "      <td>18842</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>Composition Blue T-shirt made of 100% cotton, ...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Puma Men Graphic Stellar Blue Tshirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44006</th>\n",
       "      <td>46694</td>\n",
       "      <td>Rasasi</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Style Note rasasi impresses and flatters your ...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Personal Care</td>\n",
       "      <td>Fragrance</td>\n",
       "      <td>Perfume and Body Mist</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Spring</td>\n",
       "      <td>2017</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Rasasi Women Blue Lady Perfume</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44007</th>\n",
       "      <td>51623</td>\n",
       "      <td>Fossil</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>Case style: Analogue watch, has a circular cas...</td>\n",
       "      <td>http://assets.myntassets.com/assets/images/516...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Pink</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Fossil Women Pink Dial Chronograph Watch ES3050</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>44008 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id              brand     age_group  \\\n",
       "0      15970             Turtle    Adults-Men   \n",
       "1      39386      Peter England    Adults-Men   \n",
       "2      59263              Titan  Adults-Women   \n",
       "3      21379  Manchester United    Adults-Men   \n",
       "4      53759               Puma    Adults-Men   \n",
       "...      ...                ...           ...   \n",
       "44003  17036                GAS    Adults-Men   \n",
       "44004   6461              Lotto    Adults-Men   \n",
       "44005  18842               Puma    Adults-Men   \n",
       "44006  46694             Rasasi  Adults-Women   \n",
       "44007  51623             Fossil  Adults-Women   \n",
       "\n",
       "                                             description  \\\n",
       "0      CompositionDark brown and indigo blue plaid ch...   \n",
       "1      Style Note Look cool and casual in these jeans...   \n",
       "2      Silver steel case with a fixed bezel for durab...   \n",
       "3      Composition Black Official Merchandise manches...   \n",
       "4      Grey knit polo T-shirt with moisture managemen...   \n",
       "...                                                  ...   \n",
       "44003  Have fun choosing from a collection of sneaker...   \n",
       "44004  Get ready for that long overdue trip to the be...   \n",
       "44005  Composition Blue T-shirt made of 100% cotton, ...   \n",
       "44006  Style Note rasasi impresses and flatters your ...   \n",
       "44007  Case style: Analogue watch, has a circular cas...   \n",
       "\n",
       "                                               image_url gender  \\\n",
       "0      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "1      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "2      http://assets.myntassets.com/v1/images/style/p...  Women   \n",
       "3      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "4      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "...                                                  ...    ...   \n",
       "44003  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44004  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44005  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44006  http://assets.myntassets.com/v1/images/style/p...  Women   \n",
       "44007  http://assets.myntassets.com/assets/images/516...  Women   \n",
       "\n",
       "      masterCategory subCategory            articleType baseColour  season  \\\n",
       "0            Apparel     Topwear                 Shirts  Navy Blue    Fall   \n",
       "1            Apparel  Bottomwear                  Jeans       Blue  Summer   \n",
       "2        Accessories     Watches                Watches     Silver  Winter   \n",
       "3            Apparel  Bottomwear            Track Pants      Black    Fall   \n",
       "4            Apparel     Topwear                Tshirts       Grey  Summer   \n",
       "...              ...         ...                    ...        ...     ...   \n",
       "44003       Footwear       Shoes           Casual Shoes      White  Summer   \n",
       "44004       Footwear  Flip Flops             Flip Flops        Red  Summer   \n",
       "44005        Apparel     Topwear                Tshirts       Blue    Fall   \n",
       "44006  Personal Care   Fragrance  Perfume and Body Mist       Blue  Spring   \n",
       "44007    Accessories     Watches                Watches       Pink  Winter   \n",
       "\n",
       "       year   usage                               productDisplayName  \n",
       "0      2011  Casual                 Turtle Check Men Navy Blue Shirt  \n",
       "1      2012  Casual               Peter England Men Party Blue Jeans  \n",
       "2      2016  Casual                         Titan Women Silver Watch  \n",
       "3      2011  Casual    Manchester United Men Solid Black Track Pants  \n",
       "4      2012  Casual                            Puma Men Grey T-shirt  \n",
       "...     ...     ...                                              ...  \n",
       "44003  2013  Casual                        Gas Men Caddy Casual Shoe  \n",
       "44004  2011  Casual               Lotto Men's Soccer Track Flip Flop  \n",
       "44005  2011  Casual             Puma Men Graphic Stellar Blue Tshirt  \n",
       "44006  2017  Casual                   Rasasi Women Blue Lady Perfume  \n",
       "44007  2016  Casual  Fossil Women Pink Dial Chronograph Watch ES3050  \n",
       "\n",
       "[44008 rows x 14 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_product_data = pd.merge(product_meta_from_json, metadata, on=\"id\", how=\"left\")\n",
    "all_product_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[nltk_data] Downloading package stopwords to\n",
      "[nltk_data]     /home/spartee/nltk_data...\n",
      "[nltk_data]   Package stopwords is already up-to-date!\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import nltk\n",
    "nltk.download('stopwords')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'grey knit polo shirt moisture management technology keep dry ribbed spread collar short buttoned placket short raglan sleeves mesh panel running sleeve side brand logo appliqued chest straight hem front curved hem back'"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import re\n",
    "import string\n",
    "from nltk.corpus import stopwords\n",
    "\n",
    "eng_stopwords = stopwords.words(\"english\")\n",
    "\n",
    "# use regex to remove all words after the word \"Material\"\n",
    "def clean_description(description):\n",
    "    if not description:\n",
    "        return \"\"\n",
    "    # remove unicode characters\n",
    "    description = description.encode('ascii', 'ignore').decode()\n",
    "\n",
    "    # remove punctuation\n",
    "    description = re.sub('[%s]' % re.escape(string.punctuation), ' ', description)\n",
    "\n",
    "    # clean up the spacing\n",
    "    description = re.sub('\\s{2,}', \" \", description)\n",
    "\n",
    "    # remove urls\n",
    "    description = re.sub(\"https*\\S+\", \" \", description)\n",
    "\n",
    "    # remove newlines\n",
    "    description = description.replace(\"\\n\", \" \")\n",
    "\n",
    "    # remove all numbers\n",
    "    description = re.sub('\\w*\\d+\\w*', '', description)\n",
    "\n",
    "    # split on capitalized words\n",
    "    description = \" \".join(re.split('(?=[A-Z])', description))\n",
    "\n",
    "    # remove all words after the word \"Material\"\n",
    "    description = re.sub(\"Material.*\", \"\", description)\n",
    "\n",
    "    # remove all words after the word \"Model\"\n",
    "    description = re.sub(\"Model.*\", \"\", description)\n",
    "\n",
    "    # remove the words \"wash\" \"Hand\", \"Hand Wash\", \"Hand Washable\", \"Hand Washable\", \"cold\", \"degrees\", \"detergent\", \"wring\", \"bleach\", \"iron\"\n",
    "    description = re.sub(\"wash|Hand|Hand Wash|Hand Washable|Hand Washable|cold|degrees|detergent|wring|bleach|iron\", \"\", description)\n",
    "\n",
    "    # clean up the spacing again\n",
    "    description = re.sub('\\s{2,}', \" \", description)\n",
    "\n",
    "    # make all words lowercase\n",
    "    description = description.lower()\n",
    "\n",
    "    # remove stop words (debating whether to include this)\n",
    "    description = \" \".join([word for word in description.split() if word not in eng_stopwords])\n",
    "\n",
    "    return description\n",
    "\n",
    "clean_description(all_product_data.description[4])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'cotton shirt depicts typical indian ness cannot found anywhere world india people live unconditional harmony land nice fabrics cool colours easy relaxed fit things come mind one thinks shirts little kids college goers young oldies everybody loves shirts perfect casual wear ever created man easy wear comfortable popularity shirts soaring seems life without shirt unthinkable holds barred addiction people get rid multitude colours designs fits sizes shirts come tribute astounding craze shirts eternal favourite one go shirts right away'"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_product_data[\"description\"] = all_product_data.description.apply(clean_description)\n",
    "all_product_data.description[5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/spartee/.virtualenvs/vss-fashion/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.\n",
      "  warnings.warn(\n",
      "/home/spartee/.virtualenvs/vss-fashion/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.\n",
      "  warnings.warn(msg)\n"
     ]
    }
   ],
   "source": [
    "# Resnet-18 to create image embeddings\n",
    "img2vec = Img2Vec(cuda=True)\n",
    "\n",
    "# bert variant to create text embeddings\n",
    "model = SentenceTransformer('sentence-transformers/all-mpnet-base-v2')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics.pairwise import linear_kernel\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "tf = TfidfVectorizer(analyzer='word',\n",
    "                     ngram_range=(1, 2),\n",
    "                     min_df=0,\n",
    "                     stop_words='english')\n",
    "tfidf_matrix = tf.fit_transform(all_product_data['description'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(9980, 109852)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tfidf_matrix.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "ename": "MemoryError",
     "evalue": "Unable to allocate 14.4 GiB for an array with shape (44008, 44008) and data type float64",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mMemoryError\u001b[0m                               Traceback (most recent call last)",
      "\u001b[1;32m/home/spartee/dev/Redis/vss-demo/redis-vector-search/data/prep_data_large_ds.ipynb Cell 16'\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> <a href='vscode-notebook-cell://ssh-remote%2Bthunderdome/home/spartee/dev/Redis/vss-demo/redis-vector-search/data/prep_data_large_ds.ipynb#ch0000015vscode-remote?line=0'>1</a>\u001b[0m cosine_sim \u001b[39m=\u001b[39m linear_kernel(tfidf_matrix, tfidf_matrix)\n",
      "File \u001b[0;32m~/.virtualenvs/vss-fashion/lib/python3.8/site-packages/sklearn/metrics/pairwise.py:1171\u001b[0m, in \u001b[0;36mlinear_kernel\u001b[0;34m(X, Y, dense_output)\u001b[0m\n\u001b[1;32m   1146\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[1;32m   1147\u001b[0m \u001b[39mCompute the linear kernel between X and Y.\u001b[39;00m\n\u001b[1;32m   1148\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1168\u001b[0m \u001b[39m    The Gram matrix of the linear kernel, i.e. `X @ Y.T`.\u001b[39;00m\n\u001b[1;32m   1169\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[1;32m   1170\u001b[0m X, Y \u001b[39m=\u001b[39m check_pairwise_arrays(X, Y)\n\u001b[0;32m-> 1171\u001b[0m \u001b[39mreturn\u001b[39;00m safe_sparse_dot(X, Y\u001b[39m.\u001b[39;49mT, dense_output\u001b[39m=\u001b[39;49mdense_output)\n",
      "File \u001b[0;32m~/.virtualenvs/vss-fashion/lib/python3.8/site-packages/sklearn/utils/extmath.py:160\u001b[0m, in \u001b[0;36msafe_sparse_dot\u001b[0;34m(a, b, dense_output)\u001b[0m\n\u001b[1;32m    152\u001b[0m     ret \u001b[39m=\u001b[39m a \u001b[39m@\u001b[39m b\n\u001b[1;32m    154\u001b[0m \u001b[39mif\u001b[39;00m (\n\u001b[1;32m    155\u001b[0m     sparse\u001b[39m.\u001b[39missparse(a)\n\u001b[1;32m    156\u001b[0m     \u001b[39mand\u001b[39;00m sparse\u001b[39m.\u001b[39missparse(b)\n\u001b[1;32m    157\u001b[0m     \u001b[39mand\u001b[39;00m dense_output\n\u001b[1;32m    158\u001b[0m     \u001b[39mand\u001b[39;00m \u001b[39mhasattr\u001b[39m(ret, \u001b[39m\"\u001b[39m\u001b[39mtoarray\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[1;32m    159\u001b[0m ):\n\u001b[0;32m--> 160\u001b[0m     \u001b[39mreturn\u001b[39;00m ret\u001b[39m.\u001b[39;49mtoarray()\n\u001b[1;32m    161\u001b[0m \u001b[39mreturn\u001b[39;00m ret\n",
      "File \u001b[0;32m~/.virtualenvs/vss-fashion/lib/python3.8/site-packages/scipy/sparse/_compressed.py:1051\u001b[0m, in \u001b[0;36m_cs_matrix.toarray\u001b[0;34m(self, order, out)\u001b[0m\n\u001b[1;32m   1049\u001b[0m \u001b[39mif\u001b[39;00m out \u001b[39mis\u001b[39;00m \u001b[39mNone\u001b[39;00m \u001b[39mand\u001b[39;00m order \u001b[39mis\u001b[39;00m \u001b[39mNone\u001b[39;00m:\n\u001b[1;32m   1050\u001b[0m     order \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_swap(\u001b[39m'\u001b[39m\u001b[39mcf\u001b[39m\u001b[39m'\u001b[39m)[\u001b[39m0\u001b[39m]\n\u001b[0;32m-> 1051\u001b[0m out \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_process_toarray_args(order, out)\n\u001b[1;32m   1052\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m (out\u001b[39m.\u001b[39mflags\u001b[39m.\u001b[39mc_contiguous \u001b[39mor\u001b[39;00m out\u001b[39m.\u001b[39mflags\u001b[39m.\u001b[39mf_contiguous):\n\u001b[1;32m   1053\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mValueError\u001b[39;00m(\u001b[39m'\u001b[39m\u001b[39mOutput array must be C or F contiguous\u001b[39m\u001b[39m'\u001b[39m)\n",
      "File \u001b[0;32m~/.virtualenvs/vss-fashion/lib/python3.8/site-packages/scipy/sparse/_base.py:1291\u001b[0m, in \u001b[0;36mspmatrix._process_toarray_args\u001b[0;34m(self, order, out)\u001b[0m\n\u001b[1;32m   1289\u001b[0m     \u001b[39mreturn\u001b[39;00m out\n\u001b[1;32m   1290\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m-> 1291\u001b[0m     \u001b[39mreturn\u001b[39;00m np\u001b[39m.\u001b[39;49mzeros(\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mshape, dtype\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mdtype, order\u001b[39m=\u001b[39;49morder)\n",
      "\u001b[0;31mMemoryError\u001b[0m: Unable to allocate 14.4 GiB for an array with shape (44008, 44008) and data type float64"
     ]
    }
   ],
   "source": [
    "cosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "# write function to get recommendations based on cosine similarity\n",
    "prods = all_product_data.reset_index()\n",
    "prod_names = prods['productDisplayName']\n",
    "indices = pd.Series(prods.index, index=prods['productDisplayName'])\n",
    "\n",
    "def get_recommendations(product_name):\n",
    "    try:\n",
    "        # handle duplicates\n",
    "        idx = indices[product_name][0]\n",
    "    except IndexError:\n",
    "        idx = indices[product_name]\n",
    "    sim_scores = list(enumerate(cosine_sim[idx]))\n",
    "    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n",
    "    sim_scores = sim_scores[1:15]\n",
    "    product_indicies = [i[0] for i in sim_scores]\n",
    "    return prod_names.iloc[product_indicies]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Name: 200 \n",
      "Description: crafted superior quality leather designed practicality wallet newhide makes perfect everyday wallet open width cm height cm made pure leather brand name embossed outer one zippered compartment one open compartment left right flaps card holders compartment side care wipe surface clean dry cloth remove dust\n"
     ]
    }
   ],
   "source": [
    "index = 200\n",
    "name= prods.iloc[index].name\n",
    "desc = prods.iloc[index].description\n",
    "print(\"Name:\", name, \"\\nDescription:\", desc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "6251                  Lino Perros Women Solid Grey Wallet\n",
       "8173    United Colors of Benetton Women Solid Coffee B...\n",
       "6455                   Wrangler Leather Men Brown Wallets\n",
       "542     United Colors of Benetton Women Solid DK.Grey ...\n",
       "5377                Lino Perros Women Solid Brown Handbag\n",
       "9846        Spice Art Women Gold Embroidery Purple Clutch\n",
       "8456                           Murcia Women Brown Handbag\n",
       "8771                     Newhide Brown Men Antique Wallet\n",
       "5544                      Newhide Black Men Casual Wallet\n",
       "6131                       Lino Perros Women Green Wallet\n",
       "9183                         Lino Perros Women Red Wallet\n",
       "3469                    Fastrack Women Leather Red Wallet\n",
       "9282                             Newhide Authentic Wallet\n",
       "7996            Lino Perros Purple Women Casual Sling Bag\n",
       "Name: productDisplayName, dtype: object"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_recommendations(name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>brand</th>\n",
       "      <th>age_group</th>\n",
       "      <th>description</th>\n",
       "      <th>image_url</th>\n",
       "      <th>gender</th>\n",
       "      <th>masterCategory</th>\n",
       "      <th>subCategory</th>\n",
       "      <th>articleType</th>\n",
       "      <th>baseColour</th>\n",
       "      <th>season</th>\n",
       "      <th>year</th>\n",
       "      <th>usage</th>\n",
       "      <th>productDisplayName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>15970</td>\n",
       "      <td>Turtle</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>composition dark brown indigo blue plaid check...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Shirts</td>\n",
       "      <td>Navy Blue</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Turtle Check Men Navy Blue Shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>39386</td>\n",
       "      <td>Peter England</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>style note look cool casual jeans peter englan...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Jeans</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Peter England Men Party Blue Jeans</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>59263</td>\n",
       "      <td>Titan</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>silver steel case fixed bezel durability style...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Silver</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Titan Women Silver Watch</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21379</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>composition black official merchandise manches...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Bottomwear</td>\n",
       "      <td>Track Pants</td>\n",
       "      <td>Black</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Manchester United Men Solid Black Track Pants</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>53759</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>grey knit polo shirt moisture management techn...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>Grey</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2012</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Puma Men Grey T-shirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44003</th>\n",
       "      <td>17036</td>\n",
       "      <td>GAS</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>fun choosing collection sneakers gas comfy sty...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Shoes</td>\n",
       "      <td>Casual Shoes</td>\n",
       "      <td>White</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2013</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Gas Men Caddy Casual Shoe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44004</th>\n",
       "      <td>6461</td>\n",
       "      <td>Lotto</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>get ready long overdue trip beautiful woodland...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Footwear</td>\n",
       "      <td>Flip Flops</td>\n",
       "      <td>Flip Flops</td>\n",
       "      <td>Red</td>\n",
       "      <td>Summer</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Lotto Men's Soccer Track Flip Flop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44005</th>\n",
       "      <td>18842</td>\n",
       "      <td>Puma</td>\n",
       "      <td>Adults-Men</td>\n",
       "      <td>composition blue shirt made cotton round neck ...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Men</td>\n",
       "      <td>Apparel</td>\n",
       "      <td>Topwear</td>\n",
       "      <td>Tshirts</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Fall</td>\n",
       "      <td>2011</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Puma Men Graphic Stellar Blue Tshirt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44006</th>\n",
       "      <td>46694</td>\n",
       "      <td>Rasasi</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>style note rasasi impresses flatters senses un...</td>\n",
       "      <td>http://assets.myntassets.com/v1/images/style/p...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Personal Care</td>\n",
       "      <td>Fragrance</td>\n",
       "      <td>Perfume and Body Mist</td>\n",
       "      <td>Blue</td>\n",
       "      <td>Spring</td>\n",
       "      <td>2017</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Rasasi Women Blue Lady Perfume</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44007</th>\n",
       "      <td>51623</td>\n",
       "      <td>Fossil</td>\n",
       "      <td>Adults-Women</td>\n",
       "      <td>case style analogue watch circular case fixed ...</td>\n",
       "      <td>http://assets.myntassets.com/assets/images/516...</td>\n",
       "      <td>Women</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Watches</td>\n",
       "      <td>Pink</td>\n",
       "      <td>Winter</td>\n",
       "      <td>2016</td>\n",
       "      <td>Casual</td>\n",
       "      <td>Fossil Women Pink Dial Chronograph Watch ES3050</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>44008 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id              brand     age_group  \\\n",
       "0      15970             Turtle    Adults-Men   \n",
       "1      39386      Peter England    Adults-Men   \n",
       "2      59263              Titan  Adults-Women   \n",
       "3      21379  Manchester United    Adults-Men   \n",
       "4      53759               Puma    Adults-Men   \n",
       "...      ...                ...           ...   \n",
       "44003  17036                GAS    Adults-Men   \n",
       "44004   6461              Lotto    Adults-Men   \n",
       "44005  18842               Puma    Adults-Men   \n",
       "44006  46694             Rasasi  Adults-Women   \n",
       "44007  51623             Fossil  Adults-Women   \n",
       "\n",
       "                                             description  \\\n",
       "0      composition dark brown indigo blue plaid check...   \n",
       "1      style note look cool casual jeans peter englan...   \n",
       "2      silver steel case fixed bezel durability style...   \n",
       "3      composition black official merchandise manches...   \n",
       "4      grey knit polo shirt moisture management techn...   \n",
       "...                                                  ...   \n",
       "44003  fun choosing collection sneakers gas comfy sty...   \n",
       "44004  get ready long overdue trip beautiful woodland...   \n",
       "44005  composition blue shirt made cotton round neck ...   \n",
       "44006  style note rasasi impresses flatters senses un...   \n",
       "44007  case style analogue watch circular case fixed ...   \n",
       "\n",
       "                                               image_url gender  \\\n",
       "0      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "1      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "2      http://assets.myntassets.com/v1/images/style/p...  Women   \n",
       "3      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "4      http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "...                                                  ...    ...   \n",
       "44003  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44004  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44005  http://assets.myntassets.com/v1/images/style/p...    Men   \n",
       "44006  http://assets.myntassets.com/v1/images/style/p...  Women   \n",
       "44007  http://assets.myntassets.com/assets/images/516...  Women   \n",
       "\n",
       "      masterCategory subCategory            articleType baseColour  season  \\\n",
       "0            Apparel     Topwear                 Shirts  Navy Blue    Fall   \n",
       "1            Apparel  Bottomwear                  Jeans       Blue  Summer   \n",
       "2        Accessories     Watches                Watches     Silver  Winter   \n",
       "3            Apparel  Bottomwear            Track Pants      Black    Fall   \n",
       "4            Apparel     Topwear                Tshirts       Grey  Summer   \n",
       "...              ...         ...                    ...        ...     ...   \n",
       "44003       Footwear       Shoes           Casual Shoes      White  Summer   \n",
       "44004       Footwear  Flip Flops             Flip Flops        Red  Summer   \n",
       "44005        Apparel     Topwear                Tshirts       Blue    Fall   \n",
       "44006  Personal Care   Fragrance  Perfume and Body Mist       Blue  Spring   \n",
       "44007    Accessories     Watches                Watches       Pink  Winter   \n",
       "\n",
       "       year   usage                               productDisplayName  \n",
       "0      2011  Casual                 Turtle Check Men Navy Blue Shirt  \n",
       "1      2012  Casual               Peter England Men Party Blue Jeans  \n",
       "2      2016  Casual                         Titan Women Silver Watch  \n",
       "3      2011  Casual    Manchester United Men Solid Black Track Pants  \n",
       "4      2012  Casual                            Puma Men Grey T-shirt  \n",
       "...     ...     ...                                              ...  \n",
       "44003  2013  Casual                        Gas Men Caddy Casual Shoe  \n",
       "44004  2011  Casual               Lotto Men's Soccer Track Flip Flop  \n",
       "44005  2011  Casual             Puma Men Graphic Stellar Blue Tshirt  \n",
       "44006  2017  Casual                   Rasasi Women Blue Lady Perfume  \n",
       "44007  2016  Casual  Fossil Women Pink Dial Chronograph Watch ES3050  \n",
       "\n",
       "[44008 rows x 14 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_product_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_batch(seq, size):\n",
    "    return (seq[pos:pos + size] for pos in range(0, len(seq), size))\n",
    "\n",
    "def generate_image_vectors(products, image_base_path, batch_size=1000):\n",
    "    output_dict={}\n",
    "\n",
    "    for batch in get_batch(products, batch_size):\n",
    "        product_ids = batch['id'].values.tolist()\n",
    "        image_filenames = [image_base_path + \"/\" + str(_id) + \".jpg\" for _id in product_ids]\n",
    "        images=[]   \n",
    "        converted=[]\n",
    "\n",
    "        for img_path, _id in zip(image_filenames, product_ids):\n",
    "            try:\n",
    "                img = Image.open(img_path).convert('RGB')\n",
    "                img = img.resize((224, 224))\n",
    "                images.append(img)\n",
    "                converted.append(_id)\n",
    "            except exception as e:\n",
    "                print(e)\n",
    "                #unable_to_convert -> skip to the next image\n",
    "                continue\n",
    "\n",
    "        #Generate vectors for all images in this batch\n",
    "        vec_list = img2vec.get_vec(images)\n",
    "\n",
    "        #update the dictionary to be returned\n",
    "        batch_dict= dict(zip(converted, vec_list))\n",
    "        output_dict.update(batch_dict)\n",
    "        print(f\"Processed {str(batch_size)} product images\")\n",
    "\n",
    "    return output_dict\n",
    "\n",
    "def generate_text_vectors(products_df):\n",
    "    text_vectors = {}\n",
    "    # generate text vector\n",
    "    for index, row in products_df.iterrows():\n",
    "        text_vector = model.encode(row[\"description\"])\n",
    "        text_vectors[row[\"id\"]] = text_vector.astype(np.float32)\n",
    "        if index % 1000 == 0:\n",
    "            print(f\"Processed {str(index)} product text fields\")\n",
    "    return text_vectors\n",
    "\n",
    "# combine into a single json file\n",
    "def combine_vector_dicts(txt_vectors, img_vectors, products):\n",
    "    product_vectors = []\n",
    "    for _, row in products.iterrows():\n",
    "        try:\n",
    "            _id = row[\"id\"]\n",
    "            text_vector = txt_vectors[_id].tolist()\n",
    "            img_vector = img_vectors[_id].tolist()\n",
    "            vector_dict = {\n",
    "                \"text_vector\": text_vector,\n",
    "                \"img_vector\": img_vector,\n",
    "                \"product_id\": _id\n",
    "            }\n",
    "            product_vectors.append(vector_dict)\n",
    "        except KeyError:\n",
    "            continue\n",
    "    return product_vectors\n",
    "\n",
    "def write_product_vector_json(vector_dict):\n",
    "    product_vector_json = json.dumps(vector_dict)\n",
    "    with open(\"./product_vectors.json\", \"w\") as f:\n",
    "        f.write(product_vector_json)\n",
    "\n",
    "def write_product_metadata_json(metadata_df):\n",
    "    products = []\n",
    "    for _, row in metadata_df.iterrows():\n",
    "        product = {\n",
    "            \"product_id\": row[\"id\"],\n",
    "            # create a text based representation to create a semantic embedding with\n",
    "            \"product_metadata\": {\n",
    "                \"name\": row[\"productDisplayName\"],\n",
    "                \"gender\": row[\"gender\"],\n",
    "                \"master_category\": row[\"masterCategory\"],\n",
    "                \"sub_category\": row[\"subCategory\"],\n",
    "                \"article_type\": row[\"articleType\"],\n",
    "                \"base_color\": row[\"baseColour\"],\n",
    "                \"season\": row[\"season\"],\n",
    "                \"year\": row[\"year\"],\n",
    "                \"usage\": row[\"usage\"],\n",
    "                \"keywords\": row[\"description\"],\n",
    "                \"image_url\": row[\"image_url\"],\n",
    "                \"brand\": row[\"brand\"],\n",
    "                \"age_group\": row[\"age_group\"]\n",
    "            }\n",
    "        }\n",
    "        products.append(product)\n",
    "\n",
    "    products_json = json.dumps(products)\n",
    "    with open(\"./product_metadata.json\", \"w\") as f:\n",
    "        f.write(products_json)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 500 product images\n",
      "Processed 0 product text fields\n",
      "Processed 1000 product text fields\n",
      "Processed 2000 product text fields\n",
      "Processed 3000 product text fields\n",
      "Processed 4000 product text fields\n",
      "Processed 5000 product text fields\n",
      "Processed 6000 product text fields\n",
      "Processed 7000 product text fields\n",
      "Processed 8000 product text fields\n",
      "Processed 9000 product text fields\n",
      "Processed 10000 product text fields\n",
      "Processed 11000 product text fields\n",
      "Processed 12000 product text fields\n",
      "Processed 13000 product text fields\n",
      "Processed 14000 product text fields\n",
      "Processed 15000 product text fields\n",
      "Processed 16000 product text fields\n",
      "Processed 17000 product text fields\n",
      "Processed 18000 product text fields\n",
      "Processed 19000 product text fields\n",
      "Processed 20000 product text fields\n",
      "Processed 21000 product text fields\n",
      "Processed 22000 product text fields\n",
      "Processed 23000 product text fields\n",
      "Processed 24000 product text fields\n",
      "Processed 25000 product text fields\n",
      "Processed 26000 product text fields\n",
      "Processed 27000 product text fields\n",
      "Processed 28000 product text fields\n",
      "Processed 29000 product text fields\n",
      "Processed 30000 product text fields\n",
      "Processed 31000 product text fields\n",
      "Processed 32000 product text fields\n",
      "Processed 33000 product text fields\n",
      "Processed 34000 product text fields\n",
      "Processed 35000 product text fields\n",
      "Processed 36000 product text fields\n",
      "Processed 37000 product text fields\n",
      "Processed 38000 product text fields\n",
      "Processed 39000 product text fields\n"
     ]
    }
   ],
   "source": [
    "num_products = 40000\n",
    "image_path = DATA_PATH + \"/images/\"\n",
    "image_vectors = generate_image_vectors(all_product_data[:num_products], image_path, batch_size=500)\n",
    "text_vectors = generate_text_vectors(all_product_data[:num_products])\n",
    "vector_dict = combine_vector_dicts(text_vectors, image_vectors, all_product_data)\n",
    "write_product_vector_json(vector_dict)\n",
    "write_product_metadata_json(all_product_data[:num_products])\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "2308a14f828f4c69c4b8398d837b3e8063b63cb779a5f78af30d2f59d7d7db95"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
